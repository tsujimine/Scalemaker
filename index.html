function update() {
        const shift = parseInt(keySelect.value);
        const tbody = document.getElementById('tableBody');
        tbody.innerHTML = "";
        
        const flatKeys = [1, 3, 5, 8, 10]; // Db, Eb, F, Ab, Bb
        const isFlatKey = flatKeys.includes(shift);

        scales.forEach(s => {
            const useFlat = (s.prefer === "flat") || (isFlatKey && s.prefer !== "sharp");
            const noteList = useFlat ? notesFlat : notesSharp;

            // ⁺ (オクターブ記号) を付けないように修正
            const notes = s.intervals.map(i => {
                const idx = (i + shift) % 12;
                return noteList[idx]; // ここからオクターブ計算を削除
            }).join(" ");

            tbody.innerHTML += `<tr>
                <td class="num-cell">${s.n}</td>
                <td style="font-weight:bold;">${s.name}</td>
                <td class="notes">${notes}</td>
                <td>${s.img}</td>
            </tr>`;
        });
    }
