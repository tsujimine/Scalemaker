<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scale Matrix for Composers</title>
    <style>
        body { font-family: 'Helvetica Neue', Arial, sans-serif; background: #f0f2f5; color: #333; margin: 0; padding: 0; line-height: 1.6; }
        header { background: #1a1a1a; color: white; padding: 2rem; text-align: center; box-shadow: 0 2px 10px rgba(0,0,0,0.3); }
        h1 { margin: 0; font-size: 1.8rem; letter-spacing: 2px; }
        .subtitle { font-size: 0.9rem; opacity: 0.8; margin-top: 5px; }
        main { max-width: 1100px; margin: 2rem auto; padding: 0 1rem; }
        .controls { display: flex; gap: 20px; background: white; padding: 1.5rem; border-radius: 12px; margin-bottom: 2rem; box-shadow: 0 4px 15px rgba(0,0,0,0.05); align-items: center; }
        .control-group { display: flex; align-items: center; gap: 10px; }
        label { font-weight: bold; font-size: 0.9rem; }
        select { padding: 8px 12px; font-size: 1rem; border-radius: 6px; border: 1px solid #ccc; background: #fff; cursor: pointer; }
        table { width: 100%; border-collapse: collapse; background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        th { background: #333; color: white; padding: 15px; text-align: left; font-size: 0.8rem; text-transform: uppercase; letter-spacing: 1px; }
        td { padding: 12px 15px; border-bottom: 1px solid #eee; font-size: 0.95rem; }
        .notes { font-family: 'Courier New', Courier, monospace; font-weight: bold; color: #e63946; font-size: 1.1rem; white-space: nowrap; }
        tr:hover { background-color: #f8f9fa; }
        .num-cell { text-align: center; font-weight: bold; color: #666; }
        @media (max-width: 600px) { .controls { flex-direction: column; align-items: flex-start; } .notes { font-size: 0.9rem; white-space: normal; } }
    </style>
</head>
<body>

<header>
    <h1>ğŸ¼ Scale Matrix</h1>
    <div class="subtitle">ã‚½ãƒŠã‚¿å±•é–‹éƒ¨ã®ãŸã‚ã®ã‚¹ã‚±ãƒ¼ãƒ«ç®—å‡ºãƒ„ãƒ¼ãƒ«</div>
</header>

<main>
    <div class="controls">
        <div class="control-group">
            <label for="keySelect">Root Key:</label>
            <select id="keySelect" onchange="update()"></select>
        </div>
        <div class="subtitle">â€»Keyã¨æ—‹æ³•ã®æ€§è³ªã«åŸºã¥ãç•°ååŒéŸ³ï¼ˆ# / bï¼‰ã‚’è‡ªå‹•èª¿æ•´ã—ã¾ã™</div>
    </div>

    <table>
        <thead>
            <tr>
                <th>éŸ³æ•°</th>
                <th>ã‚¹ã‚±ãƒ¼ãƒ«å</th>
                <th>æ§‹æˆéŸ³</th>
                <th>ã‚¤ãƒ¡ãƒ¼ã‚¸ãƒ»ç”¨é€”</th>
            </tr>
        </thead>
        <tbody id="tableBody"></tbody>
    </table>
</main>

<script>
    // ç•°ååŒéŸ³å¯¾å¿œã®éŸ³åå®šç¾©
    const notesSharp = ["C", "C#", "D", "D#", "E", "F", "F#", "G", "G#", "A", "A#", "B"];
    const notesFlat  = ["C", "Db", "D", "Eb", "E", "F", "Gb", "G", "Ab", "A", "Bb", "B"];
    
    // ã‚¹ã‚±ãƒ¼ãƒ«ãƒ‡ãƒ¼ã‚¿ã« 'prefer' (è¡¨è¨˜ã®å¥½ã¿) ã‚’è¿½åŠ 
    const scales = [
        { n: 5, name: "ç‰çƒéŸ³éš", intervals: [0, 4, 5, 7, 11], img: "å—å›½çš„ãƒ»å¤ªé™½", prefer: "sharp" },
        { n: 5, name: "å¾‹æ—‹æ³•", intervals: [0, 2, 5, 7, 9], img: "é›…æ¥½ãƒ»é™è¬", prefer: "sharp" },
        { n: 5, name: "é™°æ—‹æ³•", intervals: [0, 1, 5, 7, 8], img: "å’Œã®å“€æ„ãƒ»é‹å‘½", prefer: "flat" },
        { n: 5, name: "ã‚¸ãƒ£ãƒãƒ‹ãƒ¼ã‚º", intervals: [0, 1, 3, 7, 8], img: "ç†±å¸¯ãƒ»ã‚¬ãƒ ãƒ©ãƒ³é¢¨", prefer: "flat" },
        { n: 6, name: "å…¨éŸ³éŸ³éš", intervals: [0, 2, 4, 6, 8, 10], img: "å¤¢å¹»ãƒ»æ–¹å‘å–ªå¤±", prefer: "sharp" },
        { n: 6, name: "ç¥ç§˜éŸ³éš", intervals: [0, 2, 4, 6, 9, 10], img: "ã‚¹ã‚¯ãƒªãƒ£ãƒ¼ãƒ“ãƒ³ãƒ»æ³•æ‚¦", prefer: "sharp" },
        { n: 7, name: "ã‚¢ã‚¤ã‚ªãƒ‹ã‚¢ãƒ³", intervals: [0, 2, 4, 5, 7, 9, 11], img: "é•·éŸ³éšãƒ»ç¾å®Ÿ", prefer: "sharp" },
        { n: 7, name: "ãƒªãƒ‡ã‚£ã‚¢ãƒ³", intervals: [0, 2, 4, 6, 7, 9, 11], img: "ç¥è©±çš„å…‰ (#4)", prefer: "sharp" },
        { n: 7, name: "ãƒŸã‚¯ã‚½ãƒªãƒ‡ã‚£ã‚¢ãƒ³", intervals: [0, 2, 4, 5, 7, 9, 10], img: "ç¥ç¥­ãƒ»é–‹æ”¾ (b7)", prefer: "flat" },
        { n: 7, name: "ãƒ‰ãƒªã‚¢ãƒ³", intervals: [0, 2, 3, 5, 7, 9, 10], img: "æ°—é«˜ã„å“€æ„", prefer: "flat" },
        { n: 7, name: "ã‚¨ã‚ªãƒªã‚¢ãƒ³", intervals: [0, 2, 3, 5, 7, 8, 10], img: "å–ªå¤±ãƒ»çŸ­éŸ³éš", prefer: "flat" },
        { n: 7, name: "ãƒ•ãƒªã‚¸ã‚¢ãƒ³", intervals: [0, 1, 3, 5, 7, 8, 10], img: "å®¿å‘½ãƒ»åœ°ä¸‹ (b2)", prefer: "flat" },
        { n: 7, name: "ãƒ­ã‚¯ãƒªã‚¢ãƒ³", intervals: [0, 1, 3, 5, 6, 8, 10], img: "å´©å£Šãƒ»æ­» (b2/b5)", prefer: "flat" },
        { n: 7, name: "ãƒ•ãƒªã‚¸ã‚¢ãƒ³ãƒ»Dom", intervals: [0, 1, 4, 5, 7, 8, 10], img: "ã‚¨ã‚¸ãƒ—ãƒˆãƒ»ç ‚æ¼ ", prefer: "flat" },
        { n: 7, name: "ãƒãƒ³ã‚¬ãƒªãƒ¼çŸ­éŸ³éš", intervals: [0, 2, 3, 6, 7, 8, 11], img: "æƒ…å¿µãƒ»ç‹‚æ°— (#4)", prefer: "sharp" },
        { n: 7, name: "ãƒªãƒ‡ã‚£ã‚¢ãƒ³ãƒ»Aug", intervals: [0, 2, 4, 6, 8, 9, 11], img: "æ™‚ç©ºã®æ­ªã¿ (#4/#5)", prefer: "sharp" },
        { n: 8, name: "ãƒ¡ã‚·ã‚¢ãƒ³ç¬¬2æ—‹æ³•", intervals: [0, 1, 3, 4, 6, 7, 9, 10], img: "å®çŸ³ãƒ»ç¥ç§˜ãƒ»ä¸å®‰", prefer: "flat" },
        { n: 10, name: "ãƒ¡ã‚·ã‚¢ãƒ³ç¬¬7æ—‹æ³•", intervals: [0, 1, 2, 3, 5, 6, 7, 8, 9, 11], img: "ã‚«ã‚ªã‚¹ãƒ»é£½å’Œ", prefer: "sharp" },
        { n: "èºæ—‹", name: "èºæ—‹éŸ³éš(13å‘¨æœŸ)", intervals: [0, 2, 4, 6, 8, 10, 13, 15, 17, 19], img: "ç„¡é™ä¸Šæ˜‡", prefer: "sharp" }
    ];

    const keySelect = document.getElementById('keySelect');
    // Keyã®é¸æŠè‚¢ã¯åŸºæœ¬ãƒ•ãƒ©ãƒƒãƒˆè¡¨è¨˜ã§ç”Ÿæˆï¼ˆF, Bb, Eb, Abç­‰ã«å¯¾å¿œã—ã‚„ã™ã„ãŸã‚ï¼‰
    notesFlat.forEach((n, i) => {
        const opt = document.createElement('option');
        opt.value = i;
        opt.textContent = n;
        keySelect.appendChild(opt);
    });

    function update() {
        const shift = parseInt(keySelect.value);
        const tbody = document.getElementById('tableBody');
        tbody.innerHTML = "";
        
        // Root Key è‡ªä½“ãŒã‚·ãƒ£ãƒ¼ãƒ—ç³»ã‹ãƒ•ãƒ©ãƒƒãƒˆç³»ã‹ã‚’ç°¡æ˜“åˆ¤å®š
        // C, D, E, G, A, B ã¯ã‚·ãƒ£ãƒ¼ãƒ—ã€Db, Eb, F, Ab, Bb ã¯ãƒ•ãƒ©ãƒƒãƒˆå„ªå…ˆã®ãƒªã‚¹ãƒˆã‚’æƒ³å®š
        const flatKeys = [1, 3, 5, 8, 10]; // Db, Eb, F, Ab, Bb
        const isFlatKey = flatKeys.includes(shift);

        scales.forEach(s => {
            // ã‚¹ã‚±ãƒ¼ãƒ«è‡ªä½“ã®å¥½ã¿(prefer)ã¨ã€Keyã®æ€§è³ª(isFlatKey)ã‚’çµ„ã¿åˆã‚ã›ã¦è¡¨è¨˜ã‚’æ±ºå®š
            // åŸºæœ¬ã¯ã‚¹ã‚±ãƒ¼ãƒ«ã®æ€§è³ªã‚’å„ªå…ˆã™ã‚‹ãŒã€KeyãŒãƒ•ãƒ©ãƒƒãƒˆç³»ãªã‚‰ãƒ•ãƒ©ãƒƒãƒˆã«å¯„ã›ã‚‹
            const useFlat = (s.prefer === "flat") || (isFlatKey && s.prefer !== "sharp");
            const noteList = useFlat ? notesFlat : notesSharp;

            const notes = s.intervals.map(i => {
                const idx = (i + shift) % 12;
                const oct = Math.floor((i + shift) / 12);
                return noteList[idx] + (oct > 0 ? "âº".repeat(oct) : "");
            }).join(" ");

            tbody.innerHTML += `<tr>
                <td class="num-cell">${s.n}</td>
                <td style="font-weight:bold;">${s.name}</td>
                <td class="notes">${notes}</td>
                <td>${s.img}</td>
            </tr>`;
        });
    }

    update();
</script>
</body>
</html>
